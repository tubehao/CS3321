# database hw11

1. 

（1）**故障发生在14之后**

- **已提交事务**：T1（6），T3（13）
- **未提交事务**：T4（未提交），T2（已回滚）

需要重做：T1、T3 需要回滚）：T4

（2）**故障发生在10之后**

- 日志到10，T1已提交（6），T2已回滚（10），T3已开始未提交，T4未开始

需要重做：T1 需要回滚：T3

（3）**故障发生在9之后**

- 日志到9，T1已提交（6），T2未提交未回滚，T3已开始未提交

需要重做：T1 需要回滚：T2、T3

（4）**故障发生在7之后**

- 日志到7，T1已提交（6），T2未提交未回滚，T3未开始

需要重做：T1 需要回滚：T2

2. 

（1）**故障发生在14之后**

- **已提交**：T1（A=10，C=11），T3（A=8，B=7）
- **未提交**：T4（C=12，撤销）

**恢复过程**：

1. **T1重做**：A=10, C=11
2. **T3重做**：A=8, B=7
3. **T4回滚**：C回到T3提交前，即C=11

**最终值**：

```
A = 8
B = 7
C = 11
```

（2）**故障发生在12之后**

- 日志到12，T1已提交，T3未提交，T4未提交

1. **T1重做**：A=10, C=11
2. **T3撤销**
3. **T4未写数据**，不影响

**最终值**：

```
A = 10
B = 0
C = 11
```

（3）**故障发生在10之后**

- 日志到10，T1已提交，T2已回滚，T3未提交

1. **T1重做**：A=10, C=11
2. **T3回滚**：A、B回到T1重做后的值（A=10, C=11）

**最终值**：

```
A = 10
B = 0
C = 11
```

（4）**故障发生在9之后**

- 日志到9，T1已提交，T2、T3未提交

1. **T1重做**：A=10, C=11
2. **T2回滚**：B、C回到T1重做后的值（B=0, C=11）
3. **T3回滚**：A回到T1重做后的值（A=10）

**最终值**：

```
A = 10
B = 0
C = 11
```

（5）**故障发生在7之后**

- 日志到7，T1已提交，T2未提交

1. **T1重做**：A=10, C=11
2. **T2回滚**：B、C回到T1重做后的值（B=0, C=11）

**最终值**：

```
A = 10
B = 0
C = 11
```

（6）**故障发生在5之后**

- 日志到5，T1未提交，T2未提交

1. **T1、T2都未提交，全部回滚**，A=B=C=0

**最终值**：

```
A = 0
B = 0
C = 0
```